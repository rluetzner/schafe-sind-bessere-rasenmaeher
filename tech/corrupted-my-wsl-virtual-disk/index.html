<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>How I accidentally corrupted my WSL virtual disk and what I learned from it | Schafe sind bessere Rasenmäher</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="I love WSL. I mainly develop for Linux systems at work, but for company reasons am forced to use a Windows machine. WSL is the next best thing and I&rsquo;ve been spending almost my entire time the last few years inside this sweet Linux environment.
A few days ago however, I managed to almost destroy my WSL instance. It took me a while to figure out what exactly happened, but here it goes."><meta name=generator content="Hugo 0.109.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><meta property="og:title" content="How I accidentally corrupted my WSL virtual disk and what I learned from it"><meta property="og:description" content="I love WSL. I mainly develop for Linux systems at work, but for company reasons am forced to use a Windows machine. WSL is the next best thing and I&rsquo;ve been spending almost my entire time the last few years inside this sweet Linux environment.
A few days ago however, I managed to almost destroy my WSL instance. It took me a while to figure out what exactly happened, but here it goes."><meta property="og:type" content="article"><meta property="og:url" content="https://www.schafe-sind-bessere-rasenmaeher.de/tech/corrupted-my-wsl-virtual-disk/"><meta property="article:section" content="tech"><meta property="article:published_time" content="2023-01-12T21:07:46+01:00"><meta property="article:modified_time" content="2023-01-12T21:07:46+01:00"><meta itemprop=name content="How I accidentally corrupted my WSL virtual disk and what I learned from it"><meta itemprop=description content="I love WSL. I mainly develop for Linux systems at work, but for company reasons am forced to use a Windows machine. WSL is the next best thing and I&rsquo;ve been spending almost my entire time the last few years inside this sweet Linux environment.
A few days ago however, I managed to almost destroy my WSL instance. It took me a while to figure out what exactly happened, but here it goes."><meta itemprop=datePublished content="2023-01-12T21:07:46+01:00"><meta itemprop=dateModified content="2023-01-12T21:07:46+01:00"><meta itemprop=wordCount content="1206"><meta itemprop=keywords content="WSL,Linux,Windows,"><meta name=twitter:card content="summary"><meta name=twitter:title content="How I accidentally corrupted my WSL virtual disk and what I learned from it"><meta name=twitter:description content="I love WSL. I mainly develop for Linux systems at work, but for company reasons am forced to use a Windows machine. WSL is the next best thing and I&rsquo;ve been spending almost my entire time the last few years inside this sweet Linux environment.
A few days ago however, I managed to almost destroy my WSL instance. It took me a while to figure out what exactly happened, but here it goes."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-dark-gray><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/images/schaf-rund.png class="w100 mw5-ns" alt="Schafe sind bessere Rasenmäher"></a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Stuff page">Stuff</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/tech/ title="Tech page">Tech</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/stories/ title="Geschichten page">Geschichten</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/imprint/ title="Imprint page">Imprint</a></li></ul><div class=ananke-socials><a href=https://rollenspiel.social/@mforester target=_blank class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=me aria-label="follow on Mastodon——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://codeberg.org/rluetzner target=_blank class="codeberg ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="codeberg link" rel=noopener aria-label="follow on codeberg——Opens in a new window"><span class=icon><svg viewBox="0 0 512 512" id="svg15" sodipodi:docname="codeberg.svg" inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs19"><filter style="color-interpolation-filters:sRGB" inkscape:label="Lightness-Contrast" id="filter1778" x="0" y="0" width="1" height="1"><feColorMatrix values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0" id="feColorMatrix1776" result="fbSourceGraphic"/><feColorMatrix result="fbSourceGraphicAlpha" in="fbSourceGraphic" values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0" id="feColorMatrix1873"/><feColorMatrix id="feColorMatrix1875" values="1 0 0 0.253601 -0 0 1 0 0.253601 -0 0 0 1 0.253601 -0 0 0 0 1 0" in="fbSourceGraphic"/></filter><filter style="color-interpolation-filters:sRGB" inkscape:label="Lightness-Contrast" id="filter1782" x="0" y="0" width="1" height="1"><feColorMatrix values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0" id="feColorMatrix1780" result="fbSourceGraphic"/><feColorMatrix result="fbSourceGraphicAlpha" in="fbSourceGraphic" values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0" id="feColorMatrix1877"/><feColorMatrix id="feColorMatrix1879" values="1 0 0 0.253601 -0 0 1 0 0.253601 -0 0 0 1 0.253601 -0 0 0 0 1 0" in="fbSourceGraphic"/></filter><filter style="color-interpolation-filters:sRGB" inkscape:label="Greyscale" id="filter1786" x="0" y="0" width="1" height="1"><feColorMatrix values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0" id="feColorMatrix1784"/></filter></defs><sodipodi:namedview id="namedview17" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" inkscape:showpageshadow="2" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="1.5332031" inkscape:cx="256" inkscape:cy="204.14777" inkscape:window-width="1920" inkscape:window-height="951" inkscape:window-x="0" inkscape:window-y="32" inkscape:window-maximized="1" inkscape:current-layer="svg15"/><linearGradient id="a" gradientUnits="userSpaceOnUse" x1="259.804" x2="383.132" y1="161.4" y2="407.835"><stop offset="0" stop-color="#fff" stop-opacity="0" id="stop2"/><stop offset=".5" stop-color="#71c2ff" id="stop4"/><stop offset="1" stop-color="#39aaff" id="stop6"/></linearGradient><path d="m259.804 161.4c-.44.0-1.1.0-1.32.44l-.44 1.1 73.996 277.27a192.039 192.039.0 0086.77-74.437L261.125 162.06a1.762 1.762.0 00-1.321-.661z" fill="url(#a)" opacity=".5" id="path11" style="fill:url(#a);filter:url(#filter1782)" transform="matrix(1.3242691,0,0,1.3242691,-82.717006,-82.736123)"/><path d="m255.3 71.8a192 192 0 00-162 294l160.1-207c.5-.6 1.5-1 2.6-1s2 .4 2.6 1l160 207a192 192 0 0029.4-102c0-106-86-192-192-192a192 192 0 00-.7.0z" fill="#2185d0" id="path13" style="filter:url(#filter1778)" transform="matrix(1.3242691,0,0,1.3242691,-82.717006,-82.736123)"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://gitlab.com/rluetzner target=_blank class="gitlab ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitLab link" rel=noopener aria-label="follow on GitLab——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M29.782 199.732 256 493.714 8.074 309.699c-6.856-5.142-9.712-13.996-7.141-21.993l28.849-87.974zm75.405-174.806c-3.142-8.854-15.709-8.854-18.851.0L29.782 199.732h131.961L105.187 24.926zm56.556 174.806L256 493.714l94.257-293.982H161.743zm349.324 87.974-28.849-87.974L256 493.714l247.926-184.015c6.855-5.142 9.711-13.996 7.141-21.993zm-85.404-262.78c-3.142-8.854-15.709-8.854-18.851.0l-56.555 174.806h131.961L425.663 24.926z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/rluetzner target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://schafe-sind-bessere-rasenmaeher.de/index.xml target=_blank class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" rel=noopener aria-label="follow on RSS——Opens in a new window"><span class=icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">TECH</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">How I accidentally corrupted my WSL virtual disk and what I learned from it</h1><p class=tracked>By <strong>Robert Lützner</strong></p><time class="f6 mv4 dib tracked" datetime=2023-01-12T21:07:46+01:00>12. January 2023</time>
<span class="f6 mv4 dib tracked">- 6 minutes read</span>
<span class="f6 mv4 dib tracked">- 1206 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I love WSL. I mainly develop for Linux systems at work, but for company reasons am forced to use a Windows machine. WSL is the next best thing and I&rsquo;ve been spending almost my entire time the last few years inside this sweet Linux environment.</p><p>A few days ago however, I managed to almost destroy my WSL instance. It took me a while to figure out what exactly happened, but here it goes.</p><h2 id=the-prose-story>The prose story</h2><p>As the new year started, I took some time to clean up my system. I noticed that my drive was running pretty low on space and ran <strong>TreeSize</strong> to analyze which files were the cause. I found an old development VM that used up more than 100GB, which I finally deleted after not booting it up for more than two years.</p><p>I should have been satisfied with this huge freed up space, but I kept digging. I found out that my WSL instance takes up about 40GB, which I found weird, because there aren&rsquo;t really that many big files in there. I dug through my notes and found the following commands.</p><blockquote><p><strong>WARNING!!!</strong></p><p><strong>Although I&rsquo;ve run these commands successfully in the past, this is part of what sent me on my way of destruction.</strong></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># As Admin</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Requires the Hyper-V PowerShell Module to be installed.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Also requires Hyper-V services to be installed.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># wsl and Docker Desktop must first be stopped:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   wsl --shutdown</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   Stop Docker manually by clicking the icon.</span>
</span></span><span style=display:flex><span>Optimize-VHD -Path $env:LOCALAPPDATA\Packages\46932SUSE.openSUSETumbleweed_022rs5jcyhyac\LocalState\ext4.vhdx -Mode Full
</span></span></code></pre></div><p>After running this command, I was unable to start WSL again. It failed with an error message that sounded like <em>used by another process</em>, i.e. something on my system was blocking access to the file.</p><p>I ran <strong>Unlocker</strong>, but couldn&rsquo;t find the cause. I did some internet research and found a comment that prompted me to check the Windows Disk Management dialog. There should be a virtual disk that I was supposed to unmount.</p><p><img src=windows-disk-management.png alt="A screenshot of the Windows Disk Managment dialog."></p><p>For whatever reason, in between reading this post and opening up the dialog, I forgot all about the virtual disk and especially why it would be there in the first place. So when I opened up the dialog, I was confronted with a message box.</p><p>I tried to reproduce the issue, but I couldn&rsquo;t manage to force it again. So all I can do is describe the contents of the message box to the best of my knowledge.</p><p>If you&rsquo;ve worked with Windows and ever added a new disk to a system, you&rsquo;ve probably seen this prompt before.</p><p><em>We found a new disk that&rsquo;s not initialized. Would you like to initialize it?</em></p><p>I clicked <em>yes</em> and all of a sudden I had a shiny new <em>virtual disk drive</em>. Only&mldr;I got the sinking feeling that I did something horribly, stupidly wrong. 😨</p><p>Now my WSL still didn&rsquo;t want to start, but the error message changed ever so slightly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[process exited with code 4294967295]
</span></span></code></pre></div><p>Okay, now what? I spent a lot of time looking up parts of this message. Interestingly enough the error code<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> yielded some results, although I had to dig deep through a bunch of solutions that simply wouldn&rsquo;t work for me.</p><p>I finally found <a href=https://github.com/microsoft/WSL/issues/5092#issuecomment-1332427373>this answer</a> &ndash; the steps of which I&rsquo;m going to describe shortly &ndash; and now everything clicked.</p><h2 id=what-happened>What happened</h2><p>What I didn&rsquo;t know before is that the contents of a WSL instance are saved in a Hyper-V virtual disk. I mean I could have and probably should have known (going by the <code>.vhdx</code> file ending), but I didn&rsquo;t put two and two together. 😅</p><p>What Optimize-VHD does is</p><ul><li>mount the disk locally and</li><li>run some optimizations, defragmentation, whatever on it.</li></ul><p>The command should end up unmounting the virtual disk when it&rsquo;s finished, but it seems like I&rsquo;m not the only one for whom that didn&rsquo;t happen.</p><p>When I opened up the Windows Disk Management dialog, I was prompted to initialize the disk, because Windows wasn&rsquo;t able to read the partition table written by Linux.</p><p>Of course I then trashed the existing partition table with the Windows MBR and now Linux (or rather WSL) was no longer able to read it.</p><h2 id=how-i-fixed-it>How I fixed it</h2><p>Again, it&rsquo;s all thanks to <a href=https://github.com/microsoft/WSL/issues/5092#issuecomment-1332427373>this answer on GitHub</a>. 🚀🎉</p><p>I never would have managed to figure this out on my own.</p><p>First, I installed a new WSL instance &ndash; Ubuntu &ndash; from the Windows Store. I chose Ubuntu for two reasons.</p><ol><li>I could not install openSUSE Tumbleweed again. I would have had to delete my existing installation, which I wasn&rsquo;t yet willing to give up.</li><li>The commands and packages mentioned in the comment I found on GitHub were meant for a Debian/Ubuntu system and I didn&rsquo;t want the hassle of finding their equivalents on an openSUSE system.</li></ol><p>I started up the Ubuntu instance and ran the following commands. These are not exactly the commands you will find in the GitHub comment, because some of those have since been deprecated.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt-get install libguestfs-tools linux-image-generic
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># List all partitions from the virtual disk.</span>
</span></span><span style=display:flex><span>sudo virt-filesystems --all -a /mnt/c/Users/robertl/AppData/Local/Packages/46932SUSE.openSUSETumbleweed_022rs5jcyhyac/LocalState/ext4.vhdx
</span></span><span style=display:flex><span><span style=color:#75715e># In my case this listed</span>
</span></span><span style=display:flex><span><span style=color:#75715e># /dev/sda</span>
</span></span><span style=display:flex><span><span style=color:#75715e># /dev/sda1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo virt-rescue -a /mnt/c/Users/roberts/AppData/Local/Packages/46932SUSE.openSUSETumbleweed_022rs5jcyhyac/LocalState/ext4.vhdx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># You&#39;ve now entered rescue mode for virtual disks.</span>
</span></span><span style=display:flex><span>e2fsck -y /dev/sda
</span></span></code></pre></div><p>After this is finished, I was able to start my openSUSE Tumbleweed instance again. No data was lost.</p><h2 id=what-ive-learned>What I&rsquo;ve learned</h2><p>I already mentioned that I&rsquo;ve learned a bit about how WSL is implemented, i.e. that the data is stored in a Hyper-V virtual disk file hidden away in <code>%LOCALAPPDATA%</code>.</p><p>I wasn&rsquo;t really worried about losing any vital data. I regularly push the code I write, so no work progress would have been lost.</p><p>I usually put my scripts into versioning as well, but I had a few files lying around that came in handy recently and I hadn&rsquo;t yet figured out where to put them.</p><p>There were also my config files. I&rsquo;m not a huge tinkerer when it comes to dotfiles, but my global gitconfig contained some aliases I relied on heavily and wasn&rsquo;t sure I could recreate/find again.</p><p>I&rsquo;ve also spent some time filling out my <code>.ssh/config</code> so I can easily access a bunch of servers without having to remember the matching private key, username, port, &mldr;</p><p>I&rsquo;ve been eyeing <a href=https://www.chezmoi.io>chezmoi</a> as a backup/versioning option and I finally took the leap. It&rsquo;s been a very pleasant experience and it didn&rsquo;t take half as long as I expected to get my environment versioned. I&rsquo;ve already started with some scripts to help get a clean system up to speed quickly.</p><p>I&rsquo;m glad I could recover from my mistake, but as always: no backup, no mercy! If you&rsquo;re reading this and think to yourself <em>wow, this sounds scary</em>&mldr;how about some backup? 😊</p><p>I can really recommend <a href=https://www.chezmoi.io>chezmoi</a> for dotfiles (and even some scripts you don&rsquo;t know where to put) and I&rsquo;m planning on adding another blog post about that experience soon.</p><p>Stay tuned and thanks for reading!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Seriously Microsoft&mldr;you can&rsquo;t tell me that there&rsquo;s anybody who knows exactly what the magic error code 4294967295 means.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><ul class=pa0><li class="list di"><a href=/tags/wsl class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">WSL</a></li><li class="list di"><a href=/tags/linux class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Linux</a></li><li class="list di"><a href=/tags/windows class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Windows</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-dark-gray bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://www.schafe-sind-bessere-rasenmaeher.de>&copy; Schafe sind bessere Rasenmäher 2023</a><div><div class=ananke-socials><a href=https://rollenspiel.social/@mforester target=_blank class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=me aria-label="follow on Mastodon——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://codeberg.org/rluetzner target=_blank class="codeberg ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="codeberg link" rel=noopener aria-label="follow on codeberg——Opens in a new window"><span class=icon><svg viewBox="0 0 512 512" id="svg15" sodipodi:docname="codeberg.svg" inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs19"><filter style="color-interpolation-filters:sRGB" inkscape:label="Lightness-Contrast" id="filter1778" x="0" y="0" width="1" height="1"><feColorMatrix values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0" id="feColorMatrix1776" result="fbSourceGraphic"/><feColorMatrix result="fbSourceGraphicAlpha" in="fbSourceGraphic" values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0" id="feColorMatrix1873"/><feColorMatrix id="feColorMatrix1875" values="1 0 0 0.253601 -0 0 1 0 0.253601 -0 0 0 1 0.253601 -0 0 0 0 1 0" in="fbSourceGraphic"/></filter><filter style="color-interpolation-filters:sRGB" inkscape:label="Lightness-Contrast" id="filter1782" x="0" y="0" width="1" height="1"><feColorMatrix values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0" id="feColorMatrix1780" result="fbSourceGraphic"/><feColorMatrix result="fbSourceGraphicAlpha" in="fbSourceGraphic" values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0" id="feColorMatrix1877"/><feColorMatrix id="feColorMatrix1879" values="1 0 0 0.253601 -0 0 1 0 0.253601 -0 0 0 1 0.253601 -0 0 0 0 1 0" in="fbSourceGraphic"/></filter><filter style="color-interpolation-filters:sRGB" inkscape:label="Greyscale" id="filter1786" x="0" y="0" width="1" height="1"><feColorMatrix values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0" id="feColorMatrix1784"/></filter></defs><sodipodi:namedview id="namedview17" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" inkscape:showpageshadow="2" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="1.5332031" inkscape:cx="256" inkscape:cy="204.14777" inkscape:window-width="1920" inkscape:window-height="951" inkscape:window-x="0" inkscape:window-y="32" inkscape:window-maximized="1" inkscape:current-layer="svg15"/><linearGradient id="a" gradientUnits="userSpaceOnUse" x1="259.804" x2="383.132" y1="161.4" y2="407.835"><stop offset="0" stop-color="#fff" stop-opacity="0" id="stop2"/><stop offset=".5" stop-color="#71c2ff" id="stop4"/><stop offset="1" stop-color="#39aaff" id="stop6"/></linearGradient><path d="m259.804 161.4c-.44.0-1.1.0-1.32.44l-.44 1.1 73.996 277.27a192.039 192.039.0 0086.77-74.437L261.125 162.06a1.762 1.762.0 00-1.321-.661z" fill="url(#a)" opacity=".5" id="path11" style="fill:url(#a);filter:url(#filter1782)" transform="matrix(1.3242691,0,0,1.3242691,-82.717006,-82.736123)"/><path d="m255.3 71.8a192 192 0 00-162 294l160.1-207c.5-.6 1.5-1 2.6-1s2 .4 2.6 1l160 207a192 192 0 0029.4-102c0-106-86-192-192-192a192 192 0 00-.7.0z" fill="#2185d0" id="path13" style="filter:url(#filter1778)" transform="matrix(1.3242691,0,0,1.3242691,-82.717006,-82.736123)"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://gitlab.com/rluetzner target=_blank class="gitlab ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitLab link" rel=noopener aria-label="follow on GitLab——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M29.782 199.732 256 493.714 8.074 309.699c-6.856-5.142-9.712-13.996-7.141-21.993l28.849-87.974zm75.405-174.806c-3.142-8.854-15.709-8.854-18.851.0L29.782 199.732h131.961L105.187 24.926zm56.556 174.806L256 493.714l94.257-293.982H161.743zm349.324 87.974-28.849-87.974L256 493.714l247.926-184.015c6.855-5.142 9.711-13.996 7.141-21.993zm-85.404-262.78c-3.142-8.854-15.709-8.854-18.851.0l-56.555 174.806h131.961L425.663 24.926z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/rluetzner target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://schafe-sind-bessere-rasenmaeher.de/index.xml target=_blank class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" rel=noopener aria-label="follow on RSS——Opens in a new window"><span class=icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>